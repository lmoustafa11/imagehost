<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EOD Training Reports Portal | RadNet CCC</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #0f1729 0%, #1e3a5f 50%, #2c5282 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .portal-container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            width: 260px;
            height: auto;
        }

        .header-title {
            border-left: 4px solid #1e3a5f;
            padding-left: 20px;
        }

        .header-title h1 {
            font-size: 2.5rem;
            color: #1e3a5f;
            margin-bottom: 5px;
            font-weight: 900;
        }

        .header-title p {
            font-size: 1.1rem;
            color: #666;
        }

        .stat-pill {
            background: linear-gradient(135deg, #1e3a5f, #2c5282);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            text-align: center;
            min-width: 140px;
        }

        .stat-pill .number {
            font-size: 2rem;
            font-weight: 900;
            display: block;
            line-height: 1;
        }

        .stat-pill .label {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-top: 5px;
            display: block;
        }

        .search-filter-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .search-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .search-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e3a5f;
        }

        .results-count {
            font-size: 1rem;
            color: #666;
            background: #f0f4f8;
            padding: 8px 16px;
            border-radius: 20px;
        }

        .search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 16px 50px 16px 20px;
            font-size: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #1e3a5f;
        }

        .search-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
            font-size: 20px;
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .filter-group label {
            display: block;
            font-size: 0.85rem;
            font-weight: 600;
            color: #666;
            margin-bottom: 8px;
        }

        .filter-select {
            width: 100%;
            padding: 10px 15px;
            font-size: 0.95rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }

        .filter-select:focus {
            outline: none;
            border-color: #1e3a5f;
        }

        .clear-filters-btn {
            margin-top: 20px;
            padding: 10px 20px;
            background: #f0f4f8;
            border: none;
            border-radius: 8px;
            color: #1e3a5f;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .clear-filters-btn:hover {
            background: #e0e7ef;
        }

        .reports-container {
            display: grid;
            gap: 16px;
        }

        .report-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 5px solid #1e3a5f;
        }

        .report-card:hover {
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .report-card.expanded {
            border-left-color: #10b981;
        }

        .report-summary {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 80px;
            gap: 20px;
            align-items: center;
        }

        .report-field {
            min-width: 0;
        }

        .report-field-label {
            font-size: 0.75rem;
            color: #999;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .report-field-value {
            font-size: 1rem;
            color: #333;
            font-weight: 600;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .status-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
            white-space: nowrap;
        }

        .status-on-schedule {
            background: #d4edda;
            color: #155724;
        }

        .status-ahead {
            background: #cce5ff;
            color: #004085;
        }

        .status-behind {
            background: #f8d7da;
            color: #721c24;
        }

        .expand-icon {
            font-size: 24px;
            color: #1e3a5f;
            transition: transform 0.3s ease;
        }

        .report-card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .report-details {
            display: none;
            margin-top: 24px;
            padding-top: 24px;
            border-top: 2px solid #f0f0f0;
            animation: slideDown 0.3s ease-out;
        }

        .report-card.expanded .report-details {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .detail-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }

        .detail-section h3 {
            font-size: 1rem;
            color: #1e3a5f;
            margin-bottom: 12px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-content {
            font-size: 0.95rem;
            color: #333;
            line-height: 1.6;
            white-space: pre-wrap;
        }

        .full-width-section {
            grid-column: 1 / -1;
        }

        .trainer-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .trainer-badge {
            background: #1e3a5f;
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .headcount-info {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .headcount-box {
            background: white;
            padding: 12px 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }

        .headcount-box .number {
            font-size: 2rem;
            font-weight: 900;
            color: #1e3a5f;
            display: block;
        }

        .headcount-box .label {
            font-size: 0.75rem;
            color: #666;
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2rem;
        }

        .no-results {
            background: white;
            border-radius: 12px;
            padding: 60px 40px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .no-results-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .no-results-text {
            font-size: 1.3rem;
            color: #666;
            font-weight: 600;
        }

        @media (max-width: 1200px) {
            .report-summary {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .expand-icon {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
            }

            .filters-grid {
                grid-template-columns: 1fr;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .report-card {
            animation: fadeInUp 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div class="portal-container">
        <div class="header">
            <div class="header-left">
                <img src="https://github.com/lmoustafa11/imagehost/blob/main/Radnet%20logo%20hi-rescropped.png?raw=true" alt="RadNet Customer Contact Center" class="logo">
                <div class="header-title">
                    <h1>EOD Training Reports</h1>
                    <p>Manager Portal - Live from Smartsheet</p>
                </div>
            </div>
            <div style="display: flex; gap: 15px; align-items: center;">
                <div class="stat-pill">
                    <span class="number" id="totalReportsHeader">0</span>
                    <span class="label">Reports</span>
                </div>
                <div class="stat-pill" style="background: linear-gradient(135deg, #10b981, #34d399); cursor: pointer; min-width: 100px;" onclick="manualSync()" title="Click to sync with Smartsheet">
                    <span class="number" style="font-size: 1.5rem;">üîÑ</span>
                    <span class="label">Sync Now</span>
                </div>
            </div>
        </div>

        <div class="search-filter-section">
            <div class="search-header">
                <div>
                    <h2 class="search-title">üîç Find Reports</h2>
                    <div id="lastSyncTime" style="font-size: 0.75rem; color: #999; margin-top: 4px;">Connecting to Smartsheet...</div>
                </div>
                <div class="results-count" id="resultsCount">Loading...</div>
            </div>

            <div class="search-box">
                <input 
                    type="text" 
                    class="search-input" 
                    id="searchInput"
                    placeholder="Search by Class ID, Trainer, Topics, Issues, or any keyword..."
                >
                <span class="search-icon">üîç</span>
            </div>

            <div class="filters-grid">
                <div class="filter-group">
                    <label for="filterServiceLevel">Service Level</label>
                    <select class="filter-select" id="filterServiceLevel">
                        <option value="">All Service Levels</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="filterTrainer">Trainer</label>
                    <select class="filter-select" id="filterTrainer">
                        <option value="">All Trainers</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="filterClassID">Class ID</label>
                    <select class="filter-select" id="filterClassID">
                        <option value="">All Classes</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="filterStatus">Status</label>
                    <select class="filter-select" id="filterStatus">
                        <option value="">All Statuses</option>
                        <option value="On schedule">On Schedule</option>
                        <option value="Ahead of schedule">Ahead of Schedule</option>
                        <option value="Behind schedule">Behind Schedule</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="filterDay">Day of Class</label>
                    <select class="filter-select" id="filterDay">
                        <option value="">All Days</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="sortBy">Sort By</label>
                    <select class="filter-select" id="sortBy">
                        <option value="date-desc">Date (Newest First)</option>
                        <option value="date-asc">Date (Oldest First)</option>
                        <option value="class">Class ID</option>
                        <option value="trainer">Trainer Name</option>
                    </select>
                </div>
            </div>

            <button class="clear-filters-btn" id="clearFilters">Clear All Filters</button>
        </div>

        <div class="reports-container" id="reportsContainer">
            <div class="loading">Loading reports from Smartsheet...</div>
        </div>
    </div>

    <script>
        const EMBEDDED_TOKEN = 'HfG7wj4gWeUTwyj4H0nFUvoWvnLHOsuYDD1Kz';
        const EMBEDDED_SHEET_ID = '5570408476528516';

        let db = [];
        let filteredReports = [];

        async function syncWithSmartsheet() {
            if (!EMBEDDED_TOKEN || !EMBEDDED_SHEET_ID) return;

            console.log('üîÑ Syncing with Smartsheet...');
            const timestamp = new Date().getTime();
            let url = `https://corsproxy.io/?` + encodeURIComponent(`https://api.smartsheet.com/2.0/sheets/${EMBEDDED_SHEET_ID}?_=${timestamp}`);

            try {
                const response = await fetch(url, {
                    headers: { 'Authorization': `Bearer ${EMBEDDED_TOKEN}`, 'Accept': 'application/json' }
                });

                if (!response.ok) throw new Error(`API Error (${response.status})`);

                const data = await response.json();
                const colMap = {};
                data.columns.forEach(c => {
                    colMap[c.id] = c.title;
                });

                db = data.rows.map(r => {
                    const obj = {};
                    r.cells.forEach(cell => {
                        const columnName = colMap[cell.columnId];
                        if (columnName) {
                            obj[columnName] = cell.displayValue || cell.value || '';
                        }
                    });
                    return obj;
                }).filter(report => {
                    // Filter out reports before 01/01/2025
                    if (report['Created date']) {
                        const createdDate = new Date(report['Created date']);
                        const cutoffDate = new Date('2025-01-01');
                        return createdDate >= cutoffDate;
                    }
                    return true; // Keep reports without a Created date
                });

                console.log(`‚úÖ Loaded ${db.length} reports from Smartsheet (filtered to 2025+)`);
                
                localStorage.setItem('eod_reports_data', JSON.stringify(db));
                const now = new Date();
                localStorage.setItem('eod_reports_timestamp', now.toISOString());

                filteredReports = [...db];
                initPortal();
                updateSyncTimestamp('Last synced: ' + now.toLocaleTimeString());

            } catch (err) {
                console.error("‚ùå Smartsheet sync failed:", err);
                
                const cachedData = localStorage.getItem('eod_reports_data');
                if (cachedData) {
                    console.log('üì¶ Loading from cache...');
                    db = JSON.parse(cachedData);
                    const cacheTime = localStorage.getItem('eod_reports_timestamp');
                    const cacheDate = new Date(cacheTime);
                    updateSyncTimestamp('Using cached data from ' + cacheDate.toLocaleString());
                } else {
                    updateSyncTimestamp('Sync failed - no cached data available');
                }
                
                filteredReports = [...db];
                initPortal();
            }
        }

        function updateSyncTimestamp(message) {
            const element = document.getElementById('lastSyncTime');
            if (element) {
                element.textContent = message;
            }
        }

        function manualSync() {
            console.log('üîÑ Manual sync triggered...');
            document.getElementById('reportsContainer').innerHTML = '<div class="loading">Syncing with Smartsheet...</div>';
            syncWithSmartsheet();
        }

        function initPortal() {
            populateFilterOptions();
            renderReports();
            setupEventListeners();
        }

        function populateFilterOptions() {
            const serviceLevels = [...new Set(db.map(r => r['Service Level']).filter(Boolean))];
            const trainers = [...new Set(db.flatMap(r => 
                (r.Trainer || '').split('\n').map(t => t.trim()).filter(Boolean)
            ))];
            const classIDs = [...new Set(db.map(r => r['Class ID']).filter(Boolean))];
            const days = [...new Set(db.map(r => r['Day of Class']).filter(Boolean))].sort((a, b) => a - b);

            populateSelect('filterServiceLevel', serviceLevels);
            populateSelect('filterTrainer', trainers.sort());
            populateSelect('filterClassID', classIDs.sort());
            populateSelect('filterDay', days);
        }

        function populateSelect(selectId, options) {
            const select = document.getElementById(selectId);
            const currentOptions = Array.from(select.options).slice(1).map(o => o.value);
            
            options.forEach(option => {
                if (!currentOptions.includes(option)) {
                    const optElement = document.createElement('option');
                    optElement.value = option;
                    optElement.textContent = option;
                    select.appendChild(optElement);
                }
            });
        }

        function renderReports() {
            const container = document.getElementById('reportsContainer');
            
            document.getElementById('totalReportsHeader').textContent = db.length;
            
            if (filteredReports.length === 0) {
                container.innerHTML = `
                    <div class="no-results">
                        <div class="no-results-icon">üì≠</div>
                        <div class="no-results-text">No reports found matching your criteria</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredReports.map((report, index) => createReportCard(report, index)).join('');
            
            document.getElementById('resultsCount').textContent = 
                `${filteredReports.length} report${filteredReports.length !== 1 ? 's' : ''} found`;
        }

        function createReportCard(report, index) {
            const trainers = (report.Trainer || '').split('\n').filter(Boolean);
            const status = report['Heat Map'] || '';
            const statusClass = status.toLowerCase().includes('ahead') ? 'status-ahead' : 
                               status.toLowerCase().includes('behind') ? 'status-behind' : 
                               'status-on-schedule';

            // Helper function to check if value is empty/N/A
            const hasValue = (val) => {
                if (!val) return false;
                const str = String(val).trim().toUpperCase();
                return str !== '' && str !== 'N/A';
            };

            return `
                <div class="report-card" data-index="${index}" onclick="toggleReport(${index})">
                    <div class="report-summary">
                        <div class="report-field">
                            <div class="report-field-label">Class ID / Service Level</div>
                            <div class="report-field-value">${report['Class ID'] || 'N/A'} ‚Ä¢ ${report['Service Level'] || 'N/A'}</div>
                        </div>
                        <div class="report-field">
                            <div class="report-field-label">Date</div>
                            <div class="report-field-value">${report['Created on'] || 'N/A'}</div>
                        </div>
                        <div class="report-field">
                            <div class="report-field-label">Day</div>
                            <div class="report-field-value">Day ${report['Day of Class'] || 'N/A'}</div>
                        </div>
                        <div class="report-field">
                            <div class="report-field-label">Trainer</div>
                            <div class="report-field-value">${trainers[0] || 'N/A'}</div>
                        </div>
                        <div class="report-field">
                            <div class="report-field-label">Status</div>
                            <span class="status-badge ${statusClass}">${status || 'N/A'}</span>
                        </div>
                        <div class="expand-icon">‚ñº</div>
                    </div>

                    <div class="report-details">
                        <div class="details-grid">
                            ${trainers.length > 0 ? `
                            <div class="detail-section">
                                <h3><span>üë•</span> Trainers</h3>
                                <div class="trainer-list">
                                    ${trainers.map(t => t.split(',').map(name => `<span class="trainer-badge">${name.trim()}</span>`).join('')).join('')}
                                </div>
                            </div>
                            ` : ''}

                            ${hasValue(report['Trainer Coach']) ? `
                            <div class="detail-section">
                                <h3><span>üéì</span> Trainer Coach</h3>
                                <div class="detail-content">${report['Trainer Coach']}</div>
                            </div>
                            ` : ''}

                            ${(hasValue(report['Day 1 Headcount']) || hasValue(report["Today's Headcount"])) ? `
                            <div class="detail-section">
                                <h3><span>üìä</span> Class Size</h3>
                                <div class="headcount-info">
                                    ${hasValue(report['Day 1 Headcount']) ? `
                                    <div class="headcount-box">
                                        <span class="number">${report['Day 1 Headcount']}</span>
                                        <span class="label">Day 1</span>
                                    </div>
                                    ` : ''}
                                    ${hasValue(report["Today's Headcount"]) ? `
                                    <div class="headcount-box">
                                        <span class="number">${report["Today's Headcount"]}</span>
                                        <span class="label">Today</span>
                                    </div>
                                    ` : ''}
                                </div>
                            </div>
                            ` : ''}

                            ${hasValue(report['Topics Covered']) ? `
                            <div class="detail-section full-width-section">
                                <h3><span>üìö</span> Topics Covered</h3>
                                <div class="detail-content">${report['Topics Covered']}</div>
                            </div>
                            ` : ''}

                            ${hasValue(report['EOD wrap up']) ? `
                            <div class="detail-section full-width-section">
                                <h3><span>üìù</span> EOD Wrap Up</h3>
                                <div class="detail-content">${report['EOD wrap up']}</div>
                            </div>
                            ` : ''}

                            ${hasValue(report['Events']) ? `
                            <div class="detail-section full-width-section">
                                <h3><span>üìÖ</span> Events</h3>
                                <div class="detail-content">${report['Events']}</div>
                            </div>
                            ` : ''}

                            ${hasValue(report['Technical Issues']) ? `
                            <div class="detail-section full-width-section">
                                <h3><span>‚öôÔ∏è</span> Technical Issues</h3>
                                <div class="detail-content">${report['Technical Issues']}</div>
                            </div>
                            ` : ''}

                            ${hasValue(report['Agent Issues']) ? `
                            <div class="detail-section full-width-section">
                                <h3><span>‚ö†Ô∏è</span> Agent Issues</h3>
                                <div class="detail-content">${report['Agent Issues']}</div>
                            </div>
                            ` : ''}

                            ${hasValue(report['Follow-Up Actions']) ? `
                            <div class="detail-section full-width-section">
                                <h3><span>üéØ</span> Follow-Up Actions</h3>
                                <div class="detail-content">${report['Follow-Up Actions']}</div>
                            </div>
                            ` : ''}

                            ${hasValue(report['Termination']) ? `
                            <div class="detail-section">
                                <h3><span>üö™</span> Terminations</h3>
                                <div class="detail-content">${report['Termination']}</div>
                            </div>
                            ` : ''}

                            ${hasValue(report['Rollover']) ? `
                            <div class="detail-section">
                                <h3><span>üîÑ</span> Rollovers</h3>
                                <div class="detail-content">${report['Rollover']}</div>
                            </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        function toggleReport(index) {
            const card = document.querySelector(`[data-index="${index}"]`);
            card.classList.toggle('expanded');
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const serviceLevel = document.getElementById('filterServiceLevel').value;
            const trainer = document.getElementById('filterTrainer').value;
            const classID = document.getElementById('filterClassID').value;
            const status = document.getElementById('filterStatus').value;
            const day = document.getElementById('filterDay').value;

            filteredReports = db.filter(report => {
                if (searchTerm) {
                    const searchableText = [
                        report['Class ID'],
                        report.Trainer,
                        report['Topics Covered'],
                        report['Technical Issues'],
                        report['Agent Issues'],
                        report['EOD wrap up'],
                        report['Events'],
                        report['Follow-Up Actions']
                    ].join(' ').toLowerCase();

                    if (!searchableText.includes(searchTerm)) return false;
                }

                if (serviceLevel && report['Service Level'] !== serviceLevel) return false;
                if (trainer && !report.Trainer?.includes(trainer)) return false;
                if (classID && report['Class ID'] !== classID) return false;
                if (status && report['Heat Map'] !== status) return false;
                if (day && report['Day of Class'] !== day) return false;

                return true;
            });

            const sortBy = document.getElementById('sortBy').value;
            sortReports(sortBy);

            renderReports();
        }

        function sortReports(sortBy) {
            switch(sortBy) {
                case 'date-desc':
                    filteredReports.sort((a, b) => new Date(b['Created date']) - new Date(a['Created date']));
                    break;
                case 'date-asc':
                    filteredReports.sort((a, b) => new Date(a['Created date']) - new Date(b['Created date']));
                    break;
                case 'class':
                    filteredReports.sort((a, b) => (a['Class ID'] || '').localeCompare(b['Class ID'] || ''));
                    break;
                case 'trainer':
                    filteredReports.sort((a, b) => (a.Trainer || '').localeCompare(b.Trainer || ''));
                    break;
            }
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('filterServiceLevel').value = '';
            document.getElementById('filterTrainer').value = '';
            document.getElementById('filterClassID').value = '';
            document.getElementById('filterStatus').value = '';
            document.getElementById('filterDay').value = '';
            document.getElementById('sortBy').value = 'date-desc';
            applyFilters();
        }

        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', applyFilters);
            document.getElementById('filterServiceLevel').addEventListener('change', applyFilters);
            document.getElementById('filterTrainer').addEventListener('change', applyFilters);
            document.getElementById('filterClassID').addEventListener('change', applyFilters);
            document.getElementById('filterStatus').addEventListener('change', applyFilters);
            document.getElementById('filterDay').addEventListener('change', applyFilters);
            document.getElementById('sortBy').addEventListener('change', applyFilters);
            document.getElementById('clearFilters').addEventListener('click', clearFilters);
        }

        window.onload = function() {
            syncWithSmartsheet();
            setInterval(() => {
                console.log('üîÑ Auto-sync...');
                syncWithSmartsheet();
            }, 5 * 60 * 1000);
        };
    </script>
</body>
</html>
